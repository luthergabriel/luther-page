<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Luther's Page</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Quicksand', sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(160deg, #e3f0ff 0%, #f4faff 100%);
      background-attachment: fixed;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
      color: #333;
      transition: background 0.5s ease, color 0.5s ease;
    }
    body.dark-mode {
      background: linear-gradient(160deg, #1a2b3c 0%, #0f1a26 100%);
      color: #e0e8f0;
    }
    body.dark-mode .container {
      background-color: #1e2e3e !important;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.5);
    }
    body.dark-mode .card {
      background-color: #24384b !important;
      box-shadow: 0 0 12px rgba(100, 150, 200, 0.2);
    }
    body.dark-mode th {
      background-color: #19507d;
      color: #d0e8ff;
    }
    body.dark-mode td, body.dark-mode th {
      border-bottom: 1px solid #3a5a7a;
    }
    body.dark-mode tr:hover {
      background-color: #2a425a;
    }
    body.dark-mode .tagline {
      color: #8ab8e0;
      border-right-color: #8ab8e0;
    }
    body.dark-mode header h1 {
      color: #a0d8f1;
    }
    .container {
      width: 90%;
      max-width: 800px;
      margin: 2rem auto;
      padding: 2rem;
      background-color: #ffffffd7;
      border-radius: 20px;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
      position: relative;
      z-index: 1;
      transition: background-color 0.4s ease;
    }
    header {
      text-align: center;
      margin-bottom: 1rem;
    }
    header h1 {
      font-family: 'Poppins', sans-serif;
      font-size: 2.5rem;
      color: #488ac7;
      transition: color 0.4s ease;
    }
    .tagline {
      font-style: italic;
      font-size: 1rem;
      color: #5d91b3;
      height: 1.2rem;
      overflow: hidden;
      border-right: .15em solid #5d91b3;
      white-space: nowrap;
      animation: typing 4s steps(40, end), blink-caret 0.75s step-end infinite;
    }
    @keyframes typing {
      from { width: 0 }
      to { width: 100% }
    }
    @keyframes blink-caret {
      from, to { border-color: transparent }
      50% { border-color: #5d91b3; }
    }
    .decorations {
      display: flex;
      justify-content: center;
      gap: 1rem;
      font-size: 1.5rem;
      margin: 1rem 0;
      flex-wrap: wrap;
    }
    .card {
      background-color: #dbeeffcc;
      padding: 1.5rem;
      border-radius: 16px;
      border: 2px dashed #ffffff;
      box-shadow: 0 0 12px rgba(255, 255, 255, 0.6);
      position: relative;
      animation: zoomIn 0.7s ease;
      margin-top: 1.5rem;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .card:hover {
      transform: scale(1.02);
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
    }
    @keyframes zoomIn {
      from { transform: scale(0.95); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    .emoji {
      position: absolute;
      top: -12px;
      right: -12px;
      font-size: 1.8rem;
      animation: float 3s ease-in-out infinite;
      text-shadow: 0 0 8px white;
    }
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-8px); }
    }
    details summary {
      cursor: pointer;
      font-weight: bold;
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
    }
    /* Responsif: Scroll horizontal untuk tabel di HP */
    .table-container {
      overflow-x: auto;
      margin-top: 1rem;
      border-radius: 8px;
      box-shadow: 0 0 6px rgba(0, 0, 0, 0.05);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background-color: #f0faff;
      min-width: 400px;
    }
    th, td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #cde6f9;
      white-space: nowrap;
    }
    th {
      background-color: #c3eaff;
      color: #2d6fa7;
    }
    body.dark-mode table {
      background-color: #1e2e3e !important;
    }
    body.dark-mode td {
      color: #e0e8f0 !important;
    }
    body.dark-mode tr:hover {
      background-color: #2a425a !important;
    }
    /* Search Icon */
    .search-icon {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 1.2rem;
      color: #5d91b3;
      cursor: pointer;
      z-index: 10;
      transition: transform 0.2s ease;
    }
    .search-icon:hover {
      transform: scale(1.1);
    }
    .search-input {
      position: absolute;
      top: 40px;
      right: 10px;
      width: 200px;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #c3eaff;
      font-family: inherit;
      font-size: 0.9rem;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      z-index: 10;
      background: white;
    }
    .delete-btn {
      background: #ff6b6b;
      color: white;
      border: none;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      font-size: 0.8rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto;
    }
    .delete-btn:hover {
      background: #e55c5c;
    }
    .add-row-btn, .change-pw-btn {
      margin-top: 0.5rem;
      font-size: 0.85rem;
      padding: 0.3rem 0.8rem;
      background: linear-gradient(145deg, #a0d8f1, #7ab8f5);
      color: white;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(106, 168, 247, 0.2);
      transition: all 0.2s ease;
      display: none;
    }
    .add-row-btn:hover, .change-pw-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(106, 168, 247, 0.3);
    }
    .add-row-btn.visible, .change-pw-btn.visible {
      display: inline-block;
    }
    footer {
      text-align: center;
      margin-top: 2rem;
      font-size: 0.9rem;
      color: #709bbf;
    }
    .edit-btn {
      background: linear-gradient(145deg, #a0d8f1, #7ab8f5);
      color: #fff;
      border: none;
      padding: 0.8rem 1.5rem;
      font-family: 'Poppins', sans-serif;
      font-size: 1rem;
      border-radius: 25px;
      box-shadow: 0 4px 10px rgba(106, 168, 247, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
      margin: 0.5rem;
      font-weight: 500;
    }
    .edit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 14px rgba(106, 168, 247, 0.4);
    }
    .floating-corner {
      position: fixed;
      bottom: 1.5rem;
      left: 1.5rem;
      font-size: 2rem;
      animation: float 4s ease-in-out infinite;
      opacity: 0.7;
      z-index: 2;
    }
    .dark-mode-toggle {
      position: fixed;
      bottom: 1.5rem;
      right: 1.5rem;
      background: #1e3a8a;
      color: white;
      border: none;
      padding: 0.8rem 1.2rem;
      border-radius: 25px;
      font-family: 'Poppins', sans-serif;
      font-size: 0.95rem;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      z-index: 1000;
    }
    .dark-mode-toggle:hover {
      background: #1e40af;
    }
    /* Bintang jatuh */
    .star {
      position: absolute;
      font-size: 1rem;
      color: #488ac7;
      animation: fall 10s linear infinite;
      opacity: 0.8;
      pointer-events: none;
      z-index: 1;
    }
    @keyframes fall {
      0% { transform: translateY(-10%); opacity: 0; }
      50% { opacity: 1; }
      100% { transform: translateY(120vh); opacity: 0; }
    }
    /* Efek trail */
    .trail {
      position: absolute;
      width: 6px;
      height: 6px;
      background-color: #96c9f3;
      border-radius: 50%;
      pointer-events: none;
      opacity: 0.8;
      box-shadow: 0 0 5px #99d4ff;
      z-index: 999;
      animation: fadeOut 0.6s forwards;
    }
    @keyframes fadeOut {
      to {
        opacity: 0;
        transform: scale(2);
      }
    }
    /* Musik Toggle */
    #musicToggle {
      position: fixed;
      bottom: 80px;
      right: 1.5rem;
      background: #1e3a8a;
      color: white;
      border: none;
      padding: 0.6rem 1rem;
      border-radius: 20px;
      font-family: 'Quicksand', sans-serif;
      font-size: 0.9rem;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    #musicToggle:hover {
      background: #5a4085;
    }
    /* Responsif untuk HP */
    @media (max-width: 600px) {
      .edit-btn {
        font-size: 0.9rem;
        padding: 0.7rem 1.2rem;
      }
      .dark-mode-toggle, #musicToggle {
        font-size: 0.9rem;
        padding: 0.6rem 1rem;
        bottom: 0.8rem;
        right: 0.8rem;
      }
      #musicToggle {
        bottom: 70px;
      }
      .add-row-btn, .change-pw-btn {
        font-size: 0.8rem;
        padding: 0.3rem 0.6rem;
      }
      .search-input {
        width: 180px;
      }
      header h1 {
        font-size: 1.8rem;
      }
      .tagline {
        font-size: 0.9rem;
        white-space: normal;
        text-align: center;
        padding: 0 0.5rem;
      }
      .container {
        width: 94%;
        padding: 1rem;
      }
      .card {
        padding: 1rem;
        font-size: 0.95rem;
      }
      .emoji {
        font-size: 1.4rem;
        top: -8px;
        right: -8px;
      }
      table, th, td {
        font-size: 0.85rem;
        word-break: break-word;
        overflow-wrap: anywhere;
      }
      .floating-corner {
        font-size: 1.4rem;
        bottom: 0.8rem;
        left: 0.8rem;
      }
      footer {
        font-size: 0.75rem;
        padding: 1rem;
      }
    }

    /* --- Style untuk Form Pesan Anonim --- */
    .anon-form {
      text-align: center;
      margin: 1.8rem 0 1.2rem;
      padding: 0 1rem;
    }
    .anon-form h3 {
      margin: 0.5rem 0 0.7rem;
      font-size: 1.1rem;
      color: #2d6fa7;
    }
    .anon-form-inner {
      display: flex;
      gap: 0.6rem;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
    }
    .anon-form textarea {
      width: 70%;
      max-width: 400px;
      padding: 0.6rem;
      border-radius: 12px;
      border: 1px solid #cde6f9;
      font-family: 'Quicksand', sans-serif;
      font-size: 0.95rem;
      resize: vertical;
      background: white;
      color: #333;
    }
    body.dark-mode .anon-form textarea {
      background: #24384b;
      color: #e0e8f0;
      border-color: #3a5a7a;
    }
    .anon-form button {
      padding: 0.6rem 1rem;
      font-size: 0.95rem;
    }

    /* --- Style untuk View Pesan --- */
    .messages-container {
      width: 90%;
      max-width: 600px;
      margin: 1.5rem auto 0;
      text-align: left;
      padding: 1rem;
      border-radius: 12px;
      background-color: #f0f8ff;
      color: #333;
      max-height: 300px;
      overflow-y: auto;
      display: none;
    }
    body.dark-mode .messages-container {
      background-color: #1e2e3e;
      color: #e0e8f0;
    }
    .message-item {
      padding: 0.8rem;
      margin-bottom: 0.5rem;
      background: #dbeeff;
      border-radius: 8px;
      font-size: 0.95rem;
      position: relative;
    }
    body.dark-mode .message-item {
      background: #2a425a;
      color: #e0e8f0;
    }
    .delete-message-btn {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: #ff6b6b;
    }
    .delete-message-btn:hover {
      transform: scale(1.1);
    }
    .no-messages {
      font-style: italic;
      color: #777;
    }
    body.dark-mode .no-messages {
      color: #aaa;
    }

    /* --- Emoji Floating di Form Pesan --- */
    .emoji-floating {
      position: absolute;
      font-size: 1.5rem;
      opacity: 0.8;
      z-index: 1;
      animation: float 3s ease-in-out infinite;
    }
    .emoji-floating-1 {
      left: 5%;
      top: -10px;
      animation-delay: 0s;
    }
    .emoji-floating-2 {
      right: 15%;
      top: -5px;
      animation-delay: 1s;
    }
    .emoji-floating-3 {
      left: 20%;
      top: 10px;
      animation-delay: 2s;
    }
  </style>
</head>
<body>
  <!-- Emoji mengambang -->
  <div class="floating-corner">‚Çç^. .^‚Çé‚üÜ</div>
  <!-- Tombol Dark Mode -->
  <button class="dark-mode-toggle" id="darkModeToggle">üåô Dark Mode</button>
  <!-- Tombol Musik -->
  <button id="musicToggle">üéµ Musik bang: OFF</button>

  <div class="container">
    <header>
      <h1>@FONTJATIM ‚≠ë</h1>
      <p class="tagline">This is @fontjatim's personal writing page...</p>
    </header>
    <div class="decorations">
      <span>üéÆ</span><span>‚öΩ</span><span>üèê</span><span>üéß</span><span>üõ†Ô∏è</span><span>üöô</span><span>üíª</span>
    </div>
    <div class="card">
      <span class="emoji">üí¨</span>
      <h2>Hi, this is Luther!</h2>
      <p id="introText">I livetweet matches, be it football, volleyball, or whatever catches my interest that day.</p>
    </div>
    <div class="card">
      <span class="emoji">üö´</span>
      <p><strong>DNI:</strong> Homophobic, Zionist, 02 voters :]</p>
    </div>
    <!-- Tabel 1: Maybe we've met at... -->
    <div class="card">
      <span class="emoji">üìç</span>
      <details>
        <summary>Maybe we've met at...</summary>
        <div style="position: relative;">
          <span class="search-icon" onclick="toggleSearch(this)">üîç</span>
          <input type="text" class="search-input" placeholder="Cari..." oninput="searchInParent(this)" style="display:none;">
        </div>
        <div class="table-container">
          <table id="table1">
            <tr><th>Agency</th><th>Muse</th><th class="delete-col"></th></tr>
          </table>
        </div>
        <button class="add-row-btn" id="addRowBtn1">+ Tambah</button>
      </details>
    </div>
    <div class="card">
      <span class="emoji">üîí</span>
      <details>
        <summary>Caretaker</summary>
        <div style="position: relative;">
          <span class="search-icon" onclick="toggleSearch(this)">üîç</span>
          <input type="text" class="search-input" placeholder="Cari..." oninput="searchInParent(this)" style="display:none;">
        </div>
        <div class="table-container">
          <table id="table2">
            <tr><th>Agency</th><th>Muse</th><th class="delete-col"></th></tr>
          </table>
        </div>
        <button class="add-row-btn" id="addRowBtn2">+ Tambah</button>
      </details>
    </div>

    <!-- üîπ Form Kirim Pesan Anonim (compact + emoji) -->
    <div class="anon-form">
      <div class="emoji-floating emoji-floating-1">Àö ‡ºò</div>
      <div class="emoji-floating emoji-floating-2">‚ãÜÔΩ°ñ¶π ¬∞.</div>
      <div class="emoji-floating emoji-floating-3">‚ãÜÔΩ°Àö</div>
      <h3>‚úâÔ∏è Ajak gw mabar roblox</h3>
      <div class="anon-form-inner">
        <textarea id="anonMessage" placeholder="Tulis aj... ini anonim awkawkawk :]" rows="2"></textarea>
        <button class="edit-btn" onclick="sendAnonymousMessage()">Kirim</button>
      </div>
    </div>

    <footer>
      <p>dibikin tahun 2025 yayayaya.</p>
    </footer>
  </div>

  <!-- Tombol Edit Konten -->
  <div style="text-align:center; margin:2rem 0;">
    <button class="edit-btn" onclick="requestPassword()">Edit</button>
  </div>

  <!-- Area Edit -->
  <div id="editSection" style="display:none; text-align:center; margin:2rem;">
    <h3>Edit Deskripsi</h3>
    <textarea id="editArea" style="width:90%; max-width:600px; height:120px; padding:1rem; border-radius:12px; border:1px solid #cde6f9; font-family:inherit;"></textarea>
    <div style="margin-top:1rem;">
      <button class="edit-btn" onclick="saveContent()">Simpan</button>
    </div>

    <!-- Button View Pesan -->
    <button class="edit-btn" style="margin-top:1.5rem;" onclick="toggleMessages()">View Pesan üì¨</button>

    <!-- Container Pesan -->
    <div id="messagesContainer" class="messages-container">
      <p class="no-messages"><i>Belum ada pesan anonim.</i></p>
    </div>
  </div>

  <script>
    // === Password System ===
    const DEFAULT_PASSWORD = "rahasia123";
    let PASSWORD = localStorage.getItem('editPassword') || DEFAULT_PASSWORD;
    const introEl = document.getElementById('introText');
    const editSection = document.getElementById('editSection');
    const editArea = document.getElementById('editArea');
    const darkModeToggle = document.getElementById('darkModeToggle');
    const addRowBtn1 = document.getElementById('addRowBtn1');
    const addRowBtn2 = document.getElementById('addRowBtn2');
    const visitCounter = document.getElementById('visitCounter');

    // === Dark Mode ===
    if (localStorage.getItem('darkMode') === 'enabled') {
      document.body.classList.add('dark-mode');
      darkModeToggle.textContent = '‚òÄÔ∏è Light Mode';
    }
    darkModeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
      if (document.body.classList.contains('dark-mode')) {
        localStorage.setItem('darkMode', 'enabled');
        darkModeToggle.textContent = '‚òÄÔ∏è Light Mode';
      } else {
        localStorage.setItem('darkMode', 'disabled');
        darkModeToggle.textContent = 'üåô Dark Mode';
      }
    });


    // === Load Intro Text ===
    const savedIntro = localStorage.getItem('editableContent');
    if (savedIntro) {
      introEl.innerText = savedIntro;
    }

    // === Load Tabel dari localStorage ===
    function loadTables() {
      const saved1 = JSON.parse(localStorage.getItem('table1Data') || '[]');
      const saved2 = JSON.parse(localStorage.getItem('table2Data') || '[]');
      const default1 = [
        ["<strong>Lapor Pah!</strong>", "Yoji Iwase (@YOJI04LP)"],
        ["<strong>Squid Game CA</strong>", "Song Eunseok (@playerEUNSEOK)"],
        ["<strong>Rock n‚Äô Rolliyah</strong>", "Shin Junghwan (@akhiSHINYU)"],
        ["<strong>Framed Memoire</strong>", "Kim Dohoon (@framedDOHOON)"],
        ["<strong>Letters With Loves</strong>", "Tokuno Yushi (@LoveTYushi)"],
        ["<strong>The Drift Knights</strong>", "R√∫ben Dias (@drift_y_dias)"],
        ["<strong>Starting XI</strong>", "Joaquin Correa (@FieldersJoa11)"],
        ["<strong>YLMB Club</strong>", "Lee Anton (@ForlornAnton)"],
        ["<strong>Fotocopy_24_Jam</strong>", "Kim Jiwoong (@24hwithjiwoong)"],
        ["<strong>Opposites Heart</strong>", "Han Yujin (@SouthYujin)"],
        ["<strong>WorldZania</strong>", "Choi Youngjae (@Zeniest05YJ)"],
        ["<strong>Uncut Pearls</strong>", "Lee Kyungmin (@JewelsKYUNGMIN)"],
        ["<strong>Loved This Way</strong>", "Choi Youngjae (@itsyojeway)"],
        ["<strong>Bluessoming</strong>", "Han Yujin (@PassYUCIL)"],
        ["<strong>Brink Hearts</strong>", "Park Sungho (@EdgeSUNGHO)"],
        ["<strong>Achebound</strong>", "Sophia Laforteza (@AGLOWPhia)"],
        ["<strong>Bestomatches</strong>", "Alejandro Garnacho (@bm4garna)"],
        ["<strong>Growned Sprouts</strong>", "Kim Woonhak (@SproutWoonhak)"],
        ["<strong>Punk Next Door</strong>", "Lee Anton (@AntonPUNKZ)"],
        ["<strong>Lovese Mosaic</strong>", "Kim Leehan (@LoveseLEEHAN)"],
        ["<strong>Fizz Rush</strong>", "Kim Leehan (@FizzlerLeehan)"],
        ["<strong>AdoredBbang</strong>", "Kim Leehan (@LeehanPhille)"],
        ["<strong>Faltered_Hello</strong>", "Asakura Jo (@hello_asakura)"],
        ["<strong>urmy_style</strong>", "Kim Leehan (@urtype_leehan)"],
        ["<strong>Beep My Heart</strong>", "Han Yujin (@YujinIsBeep)"],
        ["<strong>SolGardenia</strong>", "Park Wonbin (@CrofterWonbin)"],
        ["<strong>First Heart Beatz</strong>", "Lee Kyungmin (@KyungminBeatz)"]
      ];
      const default2 = [
        ["<strong>Nostalgic Count</strong>", "Kim Leehan (@AEROTheMire)"],
        ["<strong>Must Rush Today</strong>", "Jang Wonyoung (@GuiderMelvine)"]
      ];
      renderTable('table1', saved1.length ? saved1 : default1);
      renderTable('table2', saved2.length ? saved2 : default2);
    }

    function renderTable(tableId, data) {
      const table = document.getElementById(tableId);
      while (table.rows.length > 1) table.deleteRow(1);
      data.forEach(rowData => {
        addRowToTable(table, rowData);
      });
    }

    function addRowToTable(table, data) {
      const row = table.insertRow();
      const cell1 = row.insertCell();
      const cell2 = row.insertCell();
      const delCell = row.insertCell();
      cell1.innerHTML = data[0];
      cell2.innerHTML = data[1];
      cell1.classList.add('editable');
      cell2.classList.add('editable');
      delCell.innerHTML = '<button class="delete-btn" style="display:none;">‚ùå</button>';
      delCell.querySelector('.delete-btn').onclick = () => {
        if (confirm("Yakin km mw hapus baris ini?")) {
          row.remove();
          saveTableData();
        }
      };
    }

    function showEditElements() {
      document.querySelectorAll('.delete-btn').forEach(el => el.style.display = '');
      addRowBtn1.classList.add('visible');
      addRowBtn2.classList.add('visible');
      changePwBtn.classList.add('visible');
      makeEditable();
    }

    function hideEditElements() {
      document.querySelectorAll('.delete-btn').forEach(el => el.style.display = 'none');
      addRowBtn1.classList.remove('visible');
      addRowBtn2.classList.remove('visible');
      changePwBtn.classList.remove('visible');
    }

    function addRow(tableId) {
      const table = document.getElementById(tableId);
      const row = table.insertRow();
      const cell1 = row.insertCell();
      const cell2 = row.insertCell();
      const delCell = row.insertCell();
      cell1.innerHTML = '<strong>[Agency Baru]</strong>';
      cell2.textContent = 'Muse Baru (@handle)';
      cell1.classList.add('editable');
      cell2.classList.add('editable');
      const btn = document.createElement('button');
      btn.innerHTML = '‚ùå';
      btn.className = 'delete-btn';
      btn.style.display = '';
      btn.onclick = () => {
        if (confirm("Yakin km mw hapus baris ini?")) {
          row.remove();
          saveTableData();
        }
      };
      delCell.appendChild(btn);
      makeEditable();
      saveTableData();
    }
    addRowBtn1.onclick = () => addRow('table1');
    addRowBtn2.onclick = () => addRow('table2');

    function makeEditable() {
      document.querySelectorAll('td.editable').forEach(cell => {
        cell.ondblclick = function () {
          startEdit(this);
        };
        cell.onclick = function (e) {
          if (!this.querySelector('input') && !e.target.classList.contains('delete-btn')) {
            startEdit(this);
          }
        };
      });
    }

    function startEdit(cell) {
      const input = document.createElement('input');
      input.type = 'text';
      input.value = cell.textContent;
      input.style.width = '100%';
      input.style.padding = '8px';
      input.style.border = '2px solid #488ac7';
      input.style.borderRadius = '4px';
      input.style.fontSize = 'inherit';
      cell.innerHTML = '';
      cell.appendChild(input);
      input.focus();
      input.select();
      const save = () => {
        if (input.value.trim()) {
          cell.innerHTML = input.value
            .replace(/&/g, '&amp;')
            .replace(/</g, '<')
            .replace(/>/g, '>');
        }
        saveTableData();
        cell.onclick = () => startEdit(cell);
      };
      input.addEventListener('blur', save);
      input.addEventListener('keypress', e => {
        if (e.key === 'Enter') save();
      });
    }

    function saveTableData() {
      const table1 = Array.from(document.getElementById('table1').rows).slice(1).map(row => [
        row.cells[0].innerHTML,
        row.cells[1].innerHTML
      ]);
      const table2 = Array.from(document.getElementById('table2').rows).slice(1).map(row => [
        row.cells[0].innerHTML,
        row.cells[1].innerHTML
      ]);
      localStorage.setItem('table1Data', JSON.stringify(table1));
      localStorage.setItem('table2Data', JSON.stringify(table2));
    }

    function toggleSearch(icon) {
      const container = icon.parentNode;
      const input = container.querySelector('.search-input');
      input.style.display = input.style.display === 'none' ? 'block' : 'none';
      if (input.style.display === 'block') {
        input.focus();
      } else {
        input.value = '';
        searchInParent(input);
      }
    }

    function searchInParent(input) {
      const table = input.closest('details').querySelector('table');
      const query = input.value.toLowerCase().trim();
      Array.from(table.rows).forEach((row, index) => {
        if (index === 0) return;
        const text = row.textContent.toLowerCase();
        row.style.display = text.includes(query) ? '' : 'none';
      });
    }

    // === Ganti Password via UI ===
    function changePassword() {
      const oldPwd = prompt("Masukkan password lama:");
      if (oldPwd !== PASSWORD) {
        alert("Password lama salah :p");
        return;
      }
      const newPwd = prompt("Masukkan password baru:");
      if (!newPwd || newPwd.trim() === '') {
        alert("Password gk bleh kosong.");
        return;
      }
      const confirmPwd = prompt("Ketik ulang password baru:");
      if (newPwd !== confirmPwd) {
        alert("Password gk cocok.");
        return;
      }
      PASSWORD = newPwd;
      localStorage.setItem('editPassword', PASSWORD);
      alert("Alhamdulillah password berhasil diubah!");
    }

    // === Tambah tombol Ganti Password ===
    const changePwBtn = document.createElement('button');
    changePwBtn.textContent = "Ganti Password";
    changePwBtn.className = "change-pw-btn";
    changePwBtn.onclick = changePassword;
    document.querySelector('.container').appendChild(changePwBtn);

    // === Request Password ===
    function requestPassword() {
      const pwd = prompt("Cuma Luther yang bisa edit aowkaokw, mff yah.");
      if (pwd === PASSWORD) {
        editArea.value = introEl.innerText;
        editSection.style.display = 'block';
        showEditElements();
        playClick();
        alert("Mode edit aktif! Klik sel untuk edit atau hapus dengan ‚ùå okok?");
      } else if (pwd !== null) {
        playClick();
        alert("Password salah coo wkwkwk");
      }
    }

    function saveContent() {
      const newText = editArea.value.trim();
      if (!newText) return alert("Gk bleh kosong.");
      localStorage.setItem('editableContent', newText);
      introEl.innerText = newText;
      editSection.style.display = 'none';
      playClick();
      playConfetti();
      alert("Hore berhasil disimpan!");
    }

    // ‚úÖ Suara klik
    function playClick() {
      const audio = new Audio("audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAASWngAAAAAAAAAAAAAASWngAAAAAAATUdKUAAAAAABMS4wM0lFRC4AAAAAAAAAAAAAAA==");
      audio.volume = 0.15;
      audio.play().catch(() => {});
    }

    // ‚úÖ Confetti (sekali per hari)
    function playConfetti() {
      const today = new Date().toDateString();
      const lastConfetti = localStorage.getItem('lastConfetti');
      if (lastConfetti === today) return;
      for (let i = 0; i < 50; i++) {
        const confetti = document.createElement('div');
        confetti.textContent = ['‚ú®', 'üéâ', 'üí´', 'üå∏', 'ü´ß'][Math.floor(Math.random() * 5)];
        confetti.style.position = 'absolute';
        confetti.style.left = Math.random() * 100 + 'vw';
        confetti.style.top = Math.random() * 100 + 'vh';
        confetti.style.fontSize = (Math.random() * 10 + 10) + 'px';
        confetti.style.pointerEvents = 'none';
        confetti.style.zIndex = '1000';
        confetti.style.animation = 'fall ' + (Math.random() * 3 + 2) + 's linear forwards';
        document.body.appendChild(confetti);
        setTimeout(() => confetti.remove(), 5000);
      }
      localStorage.setItem('lastConfetti', today);
    }

    // ‚úÖ Animasi pop saat klik
    document.addEventListener('click', (e) => {
      if (e.target.matches('button, .editable, .search-icon')) {
        playClick();
        const pop = document.createElement('div');
        pop.textContent = '‡πã‡£≠ ‚≠ë‚öù';
        pop.style.position = 'absolute';
        pop.style.left = `${e.pageX}px`;
        pop.style.top = `${e.pageY}px`;
        pop.style.fontSize = '1.5rem';
        pop.style.pointerEvents = 'none';
        pop.style.transform = 'translate(-50%, -50%)';
        pop.style.zIndex = '1000';
        pop.style.animation = 'popOut 0.6s forwards';
        document.body.appendChild(pop);
        setTimeout(() => pop.remove(), 600);
      }
    });

    // Tambahkan animasi
    const style = document.createElement('style');
    style.textContent = `
      @keyframes popOut {
        0% { transform: translate(-50%, -50%) scale(0.2); opacity: 0.7; }
        100% { transform: translate(-50%, -50%) scale(1.5); opacity: 0; }
      }
      @keyframes fall {
        0% { transform: translateY(-10%); opacity: 0; }
        50% { opacity: 1; }
        100% { transform: translateY(120vh); opacity: 0; }
      }
    `;
    document.head.appendChild(style);

    // === Musik Latar Otomatis ===
    const music = new Audio('https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3');
    music.loop = true;
    music.volume = 0.3;
    const musicToggle = document.getElementById('musicToggle');
    let isPlaying = false;
    musicToggle.addEventListener('click', () => {
      if (isPlaying) {
        music.pause();
        musicToggle.innerHTML = 'üéµ Musik bang: OFF';
      } else {
        music.play().catch(() => {
          alert("Harus interaksi dulu (klik) sebelum musik bisa jalan.");
        });
        musicToggle.innerHTML = 'üé∂ Musik bang: ON';
      }
      isPlaying = !isPlaying;
    });

    // Auto-play music on first click
    document.addEventListener('click', function enableMusic() {
      document.removeEventListener('click', enableMusic);
      music.play().catch(() => {});
      isPlaying = true;
      musicToggle.innerHTML = 'üé∂ Musik bang: ON';
    }, { once: true });

    // === Fitur Pesan Anonim ===
    function sendAnonymousMessage() {
      const messageInput = document.getElementById('anonMessage');
      const message = messageInput.value.trim();
      if (!message) {
        alert("Pesan tidak boleh kosong!");
        return;
      }

      const messages = JSON.parse(localStorage.getItem('anonymousMessages') || '[]');
      messages.push({
        text: message,
        timestamp: new Date().toLocaleString('id-ID', {
          day: '2-digit',
          month: 'short',
          year: 'numeric',
          hour: '2-digit',
          minute: '2-digit'
        })
      });

      localStorage.setItem('anonymousMessages', JSON.stringify(messages));
      messageInput.value = '';
      playClick();
      alert("Pesan buat Luther udah kekirim yeah :]");
    }

    // === Tampilkan atau sembunyikan pesan ===
    function toggleMessages() {
      const container = document.getElementById('messagesContainer');
      if (container.style.display === 'block') {
        container.style.display = 'none';
      } else {
        displayMessages();
        container.style.display = 'block';
      }
    }

    function displayMessages() {
      const container = document.getElementById('messagesContainer');
      const messages = JSON.parse(localStorage.getItem('anonymousMessages') || '[]');

      if (messages.length === 0) {
        container.innerHTML = '<p class="no-messages"><i>Belum ada pesan anonim.</i></p>';
        return;
      }

      container.innerHTML = messages.reverse().map(msg => `
        <div class="message-item">
          <div><strong>${msg.timestamp}</strong></div>
          <div style="margin-top:0.3rem;">${escapeHtml(msg.text)}</div>
          <button class="delete-message-btn" onclick="deleteMessage('${msg.timestamp}')">‚ùå</button>
        </div>
      `).join('');
    }

    function deleteMessage(timestamp) {
      if (confirm("Yakin hapus pesan ini?")) {
        const messages = JSON.parse(localStorage.getItem('anonymousMessages') || '[]');
        const filtered = messages.filter(m => m.timestamp !== timestamp);
        localStorage.setItem('anonymousMessages', JSON.stringify(filtered));
        displayMessages(); // Refresh tampilan
        playClick();
      }
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    window.onload = function () {
      loadTables();
      hideEditElements();
    };
  </script>

  <!-- Efek bintang jatuh & trail -->
  <script>
    document.addEventListener('mousemove', e => {
      const dot = document.createElement('div');
      dot.classList.add('trail');
      dot.style.left = `${e.pageX}px`;
      dot.style.top = `${e.pageY}px`;
      document.body.appendChild(dot);
      setTimeout(() => dot.remove(), 500);
    });
    function createStar() {
      const star = document.createElement('div');
      star.className = 'star';
      star.innerHTML = '‚òÖ';
      star.style.left = Math.random() * window.innerWidth + 'px';
      star.style.top = '-20px';
      star.style.fontSize = (Math.random() * 1.2 + 0.6) + 'rem';
      document.body.appendChild(star);
      setTimeout(() => star.remove(), 10000);
    }
    setInterval(createStar, 1000);
  </script>
</body>
</html>